<!DOCTYPE html>
<html>

<%- include("../partials/header.ejs") %>

<body>

    <%- include("../partials/nav.ejs") %>

    <% if (typeof errors != 'undefined') { %>
        <% for (error of errors) { %>
        <div class="alert alert-danger" role="alert"><span><%= error.msg %></span></div>
        <% } %>
    <% } %>

    <div>
        <div class="container" style="margin-top: 40px;">
            <div class="row">
                <div class="col-md-4">
                    <h2 style="width: 343px;">Your rooms</h2>
                </div>
                <div class="col-md-4 d-flex justify-content-end align-self-start">
                    <i class="icon ion-search" style="font-size: 1.5em;"></i>
                    <input id="search-field" oninput="search(this)" name="search" type="search" class="form-control" placeholder="Search by name"  style="width: 80%;height: 38px;padding: 2px;margin-left: 17px;">
                </div>
                <div class="col-md-4 d-flex justify-content-end align-items-center">
                    <a class="btn d-flex align-items-center align-self-center" href="/dashboard/add" style="height: 38px;background-color: rgb(224,116,23); color:white">Add new room&nbsp;<i class="icon ion-plus-round"></i></a>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12"><table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th style="width: 10%;">Miniature</th>
                <th style="width: 50%;">Name</th>
                <th style="width: 16%;">Standard</th>
                <th style="width: 10%;">Price</th>
                <th style="width: 14%;">Actions</th>
            </tr>
        </thead>
        <tbody>
            <% if (typeof rooms != 'undefined') { %>
                <% for (room of rooms) { %>
                    <tr>
                        <td>
                            <a href="/listing/rooms/<%= room._id %>"></a>
                                <% if (typeof room.photos != 'undefined' && typeof room.photos[0] != 'undefined') { %>
                                    <img src="<%= room.photos[0] %>" style="width: 140px;"/>
                                <% } else { %>
                                    <img src="/img/no_photo.png" style="width: 140px;"/>
                                <% } %>
                            </a>
                        </td>

                        <td name="hotelName"><%= room.name %></td>
                        <td><%= room.standard %></td>
                        <td>â‚¬<%= room.price %></td>
                        <td>
                            <button type="button" class="btn btn-warning" ><a href="/dashboard/edit/<%= room._id %>"/><i class="icon ion-edit"></i></button>
                            <button type="button" class="btn btn-danger" ><i class="icon ion-android-delete"></i></i></button>
                        </td>
                    </tr>
                <% } %>
            <% } else { %>
                <tr><td colspan="5" style="text-align: center;"><i>There's nothing here yet.</i> <i class="icon ion-android-sad"></i><br>Add your first room now!</td></tr>
            <% } %>
        </tbody>
    </table></div>
            </div>
        </div>
    </div>

    <script type="application/javascript">
        function search(searchField) {
            let names = document.getElementsByName('hotelName')
            for (let name of names) {
                if (!name.innerText.toLowerCase().includes(searchField.value.toLowerCase())) {
                    name.parentElement.style.display = 'none'
                } else {
                    name.parentElement.style.removeProperty('display')
                }
            }
        }
    </script>

    <%- include("../partials/footer.ejs") %>
    <%- include("../partials/scripts.ejs") %>

</body>

</html>