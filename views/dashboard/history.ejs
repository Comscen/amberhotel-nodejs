<!DOCTYPE html>
<html>

<%- include("../partials/header.ejs") %>

<body>

    <%- include("../partials/nav.ejs") %>
    <link rel="stylesheet" href="/css/room-listing.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome5-overrides.min.css">

    <div class="container" style="margin-top: 40px;">

        <% if (typeof reservations == 'undefined') { %>
            <div class="alert" role="alert" style="background-color: rgb(224,116,37);color:white"><span>There are no reservations yet</span></div>
        <% } %>

        <% if (typeof reservations != 'undefined') { %>
            <% if (session.business !== true) { %>

                <div class="row">
                    <div class="col">
                        <h3 style="text-align: left;">Current <i class="fas fa-calendar-alt"></i></h3>
                        <hr>
                    </div>
                </div>

                <div class="row">
                    <% for (reservation of reservations) { %>
                        <% if (reservation.finished == false) { %>
                            <div class="col-md-6">
                                <div class="row" style="padding: 10px;">
                                    <table class="table">
                                        <tbody>
                                            <tr>
                                                <td colspan="2">
                                                    <a href="/account/<%= reservation.hotel._id %>">
                                                        <div class="row" style="text-align: center;">
                                                            <div class="col-md-12">
                                                                <% if(reservation.hotel.photo != undefined) { %>
                                                                    <img class="rounded-circle" src="<%= reservation.hotel.photo %>" width="60px" height="60px">
                                                                <% } else { %>   
                                                                    <img class="rounded-circle" src="/img/no_photo.png" width="60px" height="60px">
                                                                <% } %>
                                                            </div>
                                                            <div class="col-md-12" style="margin-top: 10px;">
                                                                <p>
                                                                    <%= reservation.hotel.name %>
                                                                    <span class="badge badge-primary" style="background: rgb(224,116,37);font-size: 15px;">
                                                                        <% if (reservation.hotel.rating == undefined) { %>
                                                                            No rating
                                                                        <% } else { %>
                                                                            <%= reservation.hotel.rating %>
                                                                        <% } %>
                                                                        <img src="/img/star.png" width="25px" style="margin-top: -5px;width: 15px;">
                                                                    </span>
                                                                </p>
                                                            </div>
                                                        </div>
                                                        
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 150px;">Room name</td>
                                                <td><b><%= reservation.room.name %></td>
                                            </tr>
                                            <tr>
                                                <td>Address</td>
                                                <td><b><%= reservation.hotel.address %>, <%= reservation.hotel.postalCode %> <%= reservation.hotel.city %>, <%= reservation.hotel.country %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Booking date</td>
                                                <td><b><%= reservation.createdAt.getDate() %>.<%= reservation.createdAt.getMonth() + 1 %>.<%= reservation.createdAt.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Date of visit</td>
                                                <td><b><%= reservation.startDate.getDate()  %>.<%= reservation.startDate.getMonth() + 1 %>.<%= reservation.startDate.getFullYear() %> - <%= reservation.endDate.getDate() + 1  %>.<%= reservation.endDate.getMonth() + 1 %>.<%= reservation.endDate.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Total cost</td>
                                                <td><b>€<%= reservation.totalPrice %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Payment status</td>
                                                <td style="font-size: 30px;">
                                                    <% if (reservation.paid) { %>
                                                        <i class="icon ion-checkmark-circled" style="color: green;"></i>
                                                    <% } else { %>
                                                        <i class="icon ion-close-circled" style="color: red;"></i>
                                                    <% } %>
                                                </td>
                                            </tr>
                                            <tr style="text-align: center;">
                                                <td colspan="2">
                                                    <a class="btn" href="/comments/add/hotel/<%= reservation.hotel._id %>" style="background-color: rgb(224,116,37);color: white;width: 100%;">Add comment about this hotel</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        <% } %>
                    <% } %>    
                </div>
                
                <div class="row" style="margin-top: 10px;">
                    <div class="col">
                        <h3 style="text-align: left;">Finished <i class="fas fa-calendar-check"></i></h3>
                        <hr>
                    </div>
                </div>

                <div class="row">
                    <% for (reservation of reservations) { %>
                        <% if (reservation.finished == true) { %>
                            <div class="col-md-6">
                                <div class="row" style="padding: 10px;">
                                    <table class="table">
                                        <tbody>
                                            <tr>
                                                <td colspan="2">
                                                    <a href="/account/<%= reservation.hotel._id %>">
                                                        <div class="row" style="text-align: center;">
                                                            <div class="col-md-12">
                                                                <% if(reservation.hotel.photo != undefined) { %>
                                                                    <img class="rounded-circle" src="<%= reservation.hotel.photo %>" width="60px" height="60px">
                                                                <% } else { %>   
                                                                    <img class="rounded-circle" src="/img/no_photo.png" width="60px" height="60px">
                                                                <% } %>
                                                            </div>
                                                            <div class="col-md-12" style="margin-top: 10px;">
                                                                <p>
                                                                    <%= reservation.hotel.name %>
                                                                    <span class="badge badge-primary" style="background: rgb(224,116,37);font-size: 15px;">
                                                                        <% if (reservation.hotel.rating == undefined) { %>
                                                                            No rating
                                                                        <% } else { %>
                                                                            <%= reservation.hotel.rating %>
                                                                        <% } %>
                                                                        <img src="/img/star.png" width="25px" style="margin-top: -5px;width: 15px;">
                                                                    </span>
                                                                </p>
                                                            </div>
                                                        </div>
                                                        
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 150px;">Room name</td>
                                                <td><b><%= reservation.room.name %></td>
                                            </tr>
                                            <tr>
                                                <td>Address</td>
                                                <td><b><%= reservation.hotel.address %>, <%= reservation.hotel.postalCode %> <%= reservation.hotel.city %>, <%= reservation.hotel.country %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Booking date</td>
                                                <td><b><%= reservation.createdAt.getDate() %>.<%= reservation.createdAt.getMonth() + 1 %>.<%= reservation.createdAt.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Date of visit</td>
                                                <td><b><%= reservation.startDate.getDate()  %>.<%= reservation.startDate.getMonth() + 1 %>.<%= reservation.startDate.getFullYear() %> - <%= reservation.endDate.getDate() + 1  %>.<%= reservation.endDate.getMonth() + 1 %>.<%= reservation.endDate.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Total cost</td>
                                                <td><b>€<%= reservation.totalPrice %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Payment status</td>
                                                <td style="font-size: 30px;">
                                                    <% if (reservation.paid) { %>
                                                        <i class="icon ion-checkmark-circled" style="color: green;"></i>
                                                    <% } else { %>
                                                        <i class="icon ion-close-circled" style="color: red;"></i>
                                                    <% } %>
                                                </td>
                                            </tr>
                                            <tr style="text-align: center;">
                                                <td colspan="2">
                                                    <a class="btn" href="/comments/add/hotel/<%= reservation.hotel._id %>" style="background-color: rgb(224,116,37);color: white;width: 100%;">Add comment about this hotel</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        <% } %>
                    <% } %>    
                </div>

            <% } else { %>
                <div class="row">
                    <div class="col">
                        <h3 style="text-align: left;">Current <i class="fas fa-calendar-alt"></i></h3>
                        <hr>
                    </div>
                </div>

                <div class="row">
                    <% for (reservation of reservations) { %>
                        <% if (reservation.finished == false) { %>
                            <div class="col-md-6">
                                <div class="row" style="padding: 10px;">
                                    <table class="table">
                                        <tbody>
                                            <tr>
                                                <td colspan="2">
                                                    <a href="/account/<%= reservation.user._id %>">
                                                        <div class="row" style="text-align: center;">
                                                            <div class="col-md-12">
                                                                <% if(reservation.user.photo != undefined) { %>
                                                                    <img class="rounded-circle" src="<%= reservation.user.photo %>" width="60px" height="60px">
                                                                <% } else { %>   
                                                                    <img class="rounded-circle" src="/img/no_photo.png" width="60px" height="60px">
                                                                <% } %>
                                                            </div>
                                                            <div class="col-md-12" style="margin-top: 10px;">
                                                                <p><%= reservation.user.name %> <%= reservation.user.surname %></p>
                                                            </div>
                                                        </div>
                                                        
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>E-mail address</td>
                                                <td><b><%= reservation.user.email %></b></td>
                                            </tr>
                                            <tr>
                                                <td style="width: 150px;">Room name</td>
                                                <td><b><%= reservation.room.name %></td>
                                            </tr>
                                            <tr>
                                                <td>Booking date</td>
                                                <td><b><%= reservation.createdAt.getDate() %>.<%= reservation.createdAt.getMonth() + 1 %>.<%= reservation.createdAt.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Date of visit</td>
                                                <td><b><%= reservation.startDate.getDate()  %>.<%= reservation.startDate.getMonth() + 1 %>.<%= reservation.startDate.getFullYear() %> - <%= reservation.endDate.getDate() + 1  %>.<%= reservation.endDate.getMonth() + 1 %>.<%= reservation.endDate.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Total cost</td>
                                                <td><b>€<%= reservation.totalPrice %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Payment status</td>
                                                <td style="font-size: 30px;">
                                                    <% if (reservation.paid) { %>
                                                        <i class="icon ion-checkmark-circled" style="color: green;"></i>
                                                    <% } else { %>
                                                        <i class="icon ion-close-circled" style="color: red;"></i>
                                                    <% } %>
                                                </td>
                                            </tr>
                                            <tr style="text-align: center;">
                                                <td colspan="2">
                                                    <a class="btn" href="/comments/add/user/<%= reservation.user._id %>" style="background-color: rgb(224,116,37);color: white;width: 100%;">Add comment about this user</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        <% } %>
                    <% } %>    
                </div>

                <div class="row" style="margin-top: 10px;">
                    <div class="col">
                        <h3 style="text-align: left;">Finished <i class="fas fa-calendar-check"></i></h3>
                        <hr>
                    </div>
                </div>

                <div class="row">
                    <% for (reservation of reservations) { %>
                        <% if (reservation.finished == true) { %>
                            <div class="col-md-6">
                                <div class="row" style="padding: 10px;">
                                    <table class="table">
                                        <tbody>
                                            <tr>
                                                <td colspan="2">
                                                    <a href="/account/<%= reservation.user._id %>">
                                                        <div class="row" style="text-align: center;">
                                                            <div class="col-md-12">
                                                                <% if(reservation.user.photo != undefined) { %>
                                                                    <img class="rounded-circle" src="<%= reservation.user.photo %>" width="60px" height="60px">
                                                                <% } else { %>   
                                                                    <img class="rounded-circle" src="/img/no_photo.png" width="60px" height="60px">
                                                                <% } %>
                                                            </div>
                                                            <div class="col-md-12" style="margin-top: 10px;">
                                                                <p><%= reservation.user.name %> <%= reservation.user.surname %></p>
                                                            </div>
                                                        </div>
                                                        
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>E-mail address</td>
                                                <td><b><%= reservation.user.email %></b></td>
                                            </tr>
                                            <tr>
                                                <td style="width: 150px;">Room name</td>
                                                <td><b><%= reservation.room.name %></td>
                                            </tr>
                                            <tr>
                                                <td>Booking date</td>
                                                <td><b><%= reservation.createdAt.getDate() %>.<%= reservation.createdAt.getMonth() + 1 %>.<%= reservation.createdAt.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Date of visit</td>
                                                <td><b><%= reservation.startDate.getDate()  %>.<%= reservation.startDate.getMonth() + 1 %>.<%= reservation.startDate.getFullYear() %> - <%= reservation.endDate.getDate() + 1  %>.<%= reservation.endDate.getMonth() + 1 %>.<%= reservation.endDate.getFullYear() %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Total cost</td>
                                                <td><b>€<%= reservation.totalPrice %></b></td>
                                            </tr>
                                            <tr>
                                                <td>Payment status</td>
                                                <td style="font-size: 30px;">
                                                    <% if (reservation.paid) { %>
                                                        <i class="icon ion-checkmark-circled" style="color: green;"></i>
                                                    <% } else { %>
                                                        <i class="icon ion-close-circled" style="color: red;"></i>
                                                    <% } %>
                                                </td>
                                            </tr>
                                            <tr style="text-align: center;">
                                                <td colspan="2">
                                                    <a class="btn" href="/comments/add/user/<%= reservation.user._id %>" style="background-color: rgb(224,116,37);color: white;width: 100%;">Add comment about this user</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        <% } %>
                    <% } %>    
                </div>
            <% } %>
        <% } %>

    </div>

    <%- include("../partials/footer.ejs") %>
    <%- include("../partials/scripts.ejs") %>

</body>

</html>